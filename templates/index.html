<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CryptoTrend Notifier - Advanced Analytics Dashboard</title>
    <link rel="stylesheet" href="/static/style.css" />
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link rel="icon" href="/static/images/logo.png" type="image/png" />

    <!-- Chart.js for beautiful charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- AOS for scroll animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  </head>
  <body>
    <!-- Animated Background Particles -->
    <div class="particles" id="particles"></div>

    <div class="container">
      <!-- Header -->
      <div class="header" data-aos="fade-down">
        <div class="header-content">
          <div class="header-title">
            <div class="logo">‚Çø</div>
            <div>
              <h1>CryptoTrend Notifier</h1>
              <p style="color: var(--text-secondary); margin-top: 5px">
                Real-time Analytics & Predictions
              </p>
            </div>
          </div>
          <div class="update-info">
            <div class="status-dot"></div>
            <span style="color: var(--text-secondary)">Last updated:</span>
            <span id="timestamp" style="font-weight: 600">{{ timestamp }}</span>
          </div>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="stats-grid">
        <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
          <div class="stat-header">
            <span class="stat-label">Total Market Cap</span>
            <div
              class="stat-icon"
              style="background: rgba(34, 197, 94, 0.2); color: var(--success)"
            >
              üí∞
            </div>
          </div>
          <div class="stat-value" id="marketCap">
            ${{ "{:,.2f}".format(total_market_cap / 1_000_000_000_000) }}T
          </div>
          <div
            class="stat-change {% if total_market_cap_change >= 0 %}positive{% else %}negative{% endif %}"
          >
            <span
              >{% if total_market_cap_change >= 0 %}‚Üó{% else %}‚Üò{% endif
              %}</span
            >
            <span>{{ "{:+.2f}%".format(total_market_cap_change) }} (24h)</span>
          </div>
        </div>

        <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
          <div class="stat-header">
            <span class="stat-label">Trading Volume</span>
            <div
              class="stat-icon"
              style="background: rgba(99, 102, 241, 0.2); color: var(--primary)"
            >
              üìä
            </div>
          </div>
          <div class="stat-value" id="volume">
            ${{ "{:.2f}B".format(total_volume / 1_000_000_000_000) }}
          </div>
          <div
            class="stat-change {% if total_volume_change >= 0 %}positive{% else %}negative{% endif %}"
          >
            <span
              >{% if total_volume_change >= 0 %}‚Üó{% else %}‚Üò{% endif %}</span
            >
            <span>{{ "{:+.2f}%".format(total_volume_change) }} (24h)</span>
          </div>
        </div>

        <div class="stat-card" data-aos="fade-up" data-aos-delay="300">
          <div class="stat-header">
            <span class="stat-label">BTC Dominance</span>
            <div
              class="stat-icon"
              style="background: rgba(245, 158, 11, 0.2); color: var(--warning)"
            >
              üëë
            </div>
          </div>
          <div class="stat-value" id="btcDominance">
            {{ "{:.1f}%".format(btc_dominance) }}
          </div>
          <div
            class="stat-change {% if btc_dominance_change >= 0 %}positive{% else %}negative{% endif %}"
          >
            <span
              >{% if btc_dominance_change >= 0 %}‚Üó{% else %}‚Üò{% endif %}</span
            >
            <span>{{ "{:+.1f}%".format(btc_dominance_change) }} (24h)</span>
          </div>
        </div>

        <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
          <div class="stat-header">
            <span class="stat-label">Active Coins</span>
            <div
              class="stat-icon"
              style="background: rgba(168, 85, 247, 0.2); color: #a855f7"
            >
              üöÄ
            </div>
          </div>
          <div class="stat-value" id="activeCoins">{{ prices|length }}</div>
          <div class="stat-change" style="color: var(--text-secondary)">
            <span>Tracking</span>
          </div>
        </div>
      </div>

      <!-- Main Content Grid -->
      <div class="main-grid">
        <!-- Crypto Table -->
        <div class="crypto-table-container" data-aos="fade-right">
          <div class="table-header">
            <h2 class="table-title">Live Cryptocurrency Prices</h2>
            <div class="search-box">
              <span>üîç</span>
              <input
                type="text"
                id="searchInput"
                placeholder="Search cryptocurrencies..."
              />
            </div>
          </div>

          <table class="crypto-table">
            <thead>
              <tr>
                <th>Cryptocurrency</th>
                <th>Current Price</th>
                <th>Predicted Price</th>
                <th>Trend</th>
              </tr>
            </thead>
            <tbody id="cryptoTableBody">
              {% for coin in prices %}
              <tr data-coin="{{ coin }}">
                <td>
                  <div class="crypto-name">
                    <div class="crypto-icon">{{ coin[0] }}</div>
                    <div class="crypto-info">
                      <span class="crypto-symbol">{{ coin }}</span>
                      <span class="crypto-fullname">{{ coin }} Token</span>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="price">${{ "%.2f"|format(prices[coin]) }}</div>
                </td>
                <td>
                  <div class="prediction">
                    {% if predictions[coin] %}
                    <span class="prediction-value"
                      >${{ "%.2f"|format(predictions[coin]) }}</span
                    >
                    {% else %}
                    <span style="color: var(--text-secondary)"
                      >Calculating...</span
                    >
                    {% endif %}
                  </div>
                </td>
                <td>
                  {% if predictions[coin] and predictions[coin] > prices[coin]
                  %}
                  <span class="prediction-badge bullish">üìà Bullish</span>
                  {% elif predictions[coin] and predictions[coin] < prices[coin]
                  %}
                  <span class="prediction-badge bearish">üìâ Bearish</span>
                  {% else %}
                  <span
                    class="prediction-badge"
                    style="
                      background: rgba(148, 163, 184, 0.2);
                      color: var(--text-secondary);
                    "
                    >‚è≥ Pending</span
                  >
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- Chart and Activity Feed -->
        <div>
          <div
            class="chart-container"
            data-aos="fade-left"
            data-aos-delay="100"
          >
            <h3 class="chart-title">Price Trend Analysis</h3>
            <canvas id="trendChart"></canvas>
          </div>

          <div
            class="activity-feed"
            data-aos="fade-left"
            data-aos-delay="200"
            style="margin-top: 30px"
          >
            <h3 class="chart-title">Recent Activity</h3>

            {% set recent_activities = activity_log[-3:][::-1] %} {# last 3,
            newest first #} {% if recent_activities|length > 0 %} {% for
            activity in recent_activities %} {% set bg_color = ( '34,197,94' if
            activity.color == 'success' else '99,102,241' if activity.color ==
            'primary' else '245,158,11' if activity.color == 'warning' else
            '239,68,68' if activity.color == 'danger' else '168,85,247' ) %}
            <div class="activity-item">
              <div
                class="activity-icon"
                style="background: rgba({{ bg_color }}, 0.2); color: var(--{{ activity.color }});"
              >
                {{ activity.icon }}
              </div>
              <div class="activity-content">
                <div class="activity-title">{{ activity.title }}</div>
                <div class="activity-time">{{ activity.time_ago }}</div>
              </div>
            </div>
            {% endfor %} {% else %}
            <div class="activity-item">
              <div class="activity-content">
                <div class="activity-title">No recent activity</div>
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <script src="/static/script.js"></script>
  </body>
</html>
